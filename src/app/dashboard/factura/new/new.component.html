<hr>
<div class="row">
    <div class="col-md-12">
        <form #facturaForm="ngForm">
            <div class="card">
            <div class="card-body">
                <h5 class="m-0">Nueva Factura</h5>
                <table class="table " id="dataTables-example" *ngIf="funcionario">
                    <thead>
                      <tr>
                          <th>Fecha de EX</th>
                          <th>Hora</th>
                          <th>Sede</th>
                          <th>Factura Nro</th>
                          <th>Fecha Vencimiento</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr class="odd">
                        <td>{{date| date: 'yyyy-MM-dd'}}</td>
                        <td>{{date| date: 'h:m:ss'}}</td>
                        <td>{{sedeOperativa.nombre}}</td> 
                        <td>{{factura.numero}}</td>
                        <td>{{date| date: 'yyyy-MM-dd'}}</td>
                      </tr>
                    </tbody>
                </table>
               
                <div class="col-md-12 ">
                    <div class="form-group row">
                        <div class="col-lg-12 col-md-12">
                            <label>Tipo Recaudo*</label>
                            <ng-select 
                                [multiple]="false" 
                                [options]="tiposRecaudo" 
                                [(ngModel)]="tipoRecaudoSelected" 
                                required 
                                name="tiposRecaudoId">
                            </ng-select>
                        </div>
                    </div>
                </div> 

                <div class="form-group row col-xs-12 col-lg-12">
                    <div class="col-xs-12 col-lg-12">
                        <h4>Datos Principales</h4>
                        <hr>
                    </div>
                    <div class="col-xs-12 col-lg-6">
                        <ng-select [multiple]="false" placeholder="Tipo Identificacion" [options]="tiposIdentificacion" [(ngModel)]="tipoIdentificacionSelected" required name="tiposIdentificacionId">
                        </ng-select>
                    </div>

                    <div class="col-xs-12 col-lg-6">
                        <div class="input-group" [ngClass]="{'has-danger' : isErrorCiudadano,'has-success': isExistCiudadano}">
                            <input type="text" class="form-control" placeholder="Identificacion" [(ngModel)]="identificacion" name="numeroIdentificacion" required />
                            <span class="input-group-btn">
                                <button (click)="isCiudadano()" [ngClass]="{'btn-danger' : isErrorCiudadano}" class="btn btn-default btn-success" ngxclipboard="" type="button"><i class="fa fa-search"></i></button>
                            </span>
                        </div> 
                    </div>
                    
                </div>  
                
                <div class="container col-xs-12 col-lg-12" *ngIf='isExistCiudadano'>
                    <table class="table table-bordered " id="dataTables-example">
                        <tbody>
                            <tr class="odd">
                                <td><b>Tipo de identificación</b></td>
                                <td class="center"><p>{{ciudadano.tipoIdentificacion.nombre}}</p></td>
                                <td><b>Numero de identificación</b></td>
                                <td class="center"><p>{{ciudadano.identificacion}}</p></td>
                            </tr>
                            <tr class="odd">
                                <td><b>Primer nombre</b></td>
                                <td class="center"><p>{{ciudadano.primerNombre}}</p></td>
                                <td><b>Segundo nombre</b></td>
                                <td class="center"><p>{{ciudadano.segundoNombre}}</p></td>
                            </tr>
                            <tr class="odd">
                                <td><b>Primer apellido</b></td>
                                <td class="center"><p>{{ciudadano.primerApellido}}</p></td>
                                <td><b>Segundo apellido</b></td>
                                <td class="center"><p>{{ciudadano.segundoApellido}}</p></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="col-xs-12 col-lg-12" *ngIf="tipo != 'RNC'">
                    <div class="input-group" [ngClass]="{'has-danger' : isErrorVehiculo,'has-success': isExistVehiculo}">
                        <input type="text" class="form-control" placeholder="Vin,Chasis,Motor,Serie" [(ngModel)]="vehiculoCriterio" name="placaVehiculo" required />
                        <span class="input-group-btn">
                            <button (click)="onKeyValidateVehiculo()" [ngClass]="{'btn-danger' : isErrorVehiculo}" class="btn btn-default btn-success" ngxclipboard="" type="button"><i class="fa fa-search"></i></button>
                        </span>
                        
                    </div>
                    <br>
                    <br>

                    <div class="has-danger" *ngIf="isErrorVehiculo" >
                        <div class="form-control-feedback has-danger has-error">{{msj}}</div><br>
                    </div>
    
                    <div class="has-success" *ngIf="isExistVehiculo" >
                        <div class="form-control-feedback has-danger has-success">{{msj}}</div><br>
                        <!-- tabla de detalles del vehiculo sin placa -->
                        <div class="col-xs-12 col-lg-12" >
                            <h5 class="card-title">Detalles del vehiculo <small> Encontrado</small></h5>
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th><b>Nro.Factura</b></th>
                                        <th><b>Servicio</b></th>
                                        <th><b>Clases de vehículo</b></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                        {{vehiculo.numeroFactura}}
                                        </td>
                                        <td> 
                                            {{vehiculo.servicio.nombre}}
                                        </td>
                                        <td> 
                                            {{vehiculo.clase.nombre}}
                                        </td>
                                    </tr>
                                </tbody> 
                                <thead>
                                    <tr>
                                    <th><b>Nro.Motor</b></th>
                                    <th><b>Nro.Chasis</b></th>
                                    <th><b>Nro.Serie</b></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                        {{vehiculo.motor}}
                                        </td>
                                        <td> 
                                            {{vehiculo.chasis}}
                                        </td>
                                        <td> 
                                            {{vehiculo.serie}}
                                        </td>
                                    </tr>
                                </tbody> 
                                <thead>
                                    <tr>
                                    <th><b>Nro.VIN</b></th>
                                    <th><b>Nro.Factura compra venta</b></th>
                                    <th><b>Fecha compra venta</b></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                        {{vehiculo.vin}}
                                        </td>
                                        <td> 
                                            {{vehiculo.numeroFactura}}
                                        </td>
                                        <td> 
                                            {{vehiculo.fechaFactura}}
                                        </td>
                                    </tr>
                                </tbody> 
                            </table>
                        </div><!-- fin detalles del vehiculo -->
                    </div>
                </div>

                <div class="col-xs-12 col-lg-12" *ngIf="isExistVehiculo || tipo == 'RNC'">
                    <label>Modulo*</label>
                    <ng-select
                        [multiple]="false"
                        [options]="modulos"
                        [(ngModel)]="moduloSelected"
                        (ngModelChange)="changedModulo($event)"
                        required
                        name="moduloId">
                    </ng-select>
                    <br><br>
                </div>

                <div class="col-xs-12 col-lg-12" *ngIf="isExistVehiculo || tipo == 'RNC'">
                    <label>Tramites*</label>
                    <ng-select
                        [multiple]="false"
                        [options]="tramitesPrecio"
                        [(ngModel)]="tramitePrecioSelected"
                        required
                        name="tramitePrecioId">
                    </ng-select>
                    <div class="card-footer">
                        <button (click)="btnNewTramite()" class="btn btn-primary pull-right">Agregar</button>
                    </div>
                    <br><br>
                </div>


                <div class="col-xs-12 col-lg-12">
                    <table class="table " id="dataTables-example">
                        <thead>
                            <tr>
                                <th>nombre</th>
                                <th>Valor</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="odd" *ngFor="let tramiteValor of tramitesValor; let i = index">
                                <td>{{tramiteValor.nombre}}</td>
                                <td>{{tramiteValor.valor}}</td>
                                <td>
                                    <button (click)="deleteTramiteValor(tramiteValor)"  class="btn btn-outline-danger" type="button">Eliminar</button> 
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <br>
                <div class="card-footer">
                    <div class="btn-group">
                        <button (click)="onCancelar()" class="btn btn-default">
                            <i class="fa fa-times"></i>
                            Cancelar
                        </button>
                        <button (click)="onEnviar()" class="btn btn-primary" type="button">
                            <i class="fa fa-save"></i>
                            Enviar
                        </button>
                    </div>
                </div>    
            </div>
        </div>
    </form>
</div>